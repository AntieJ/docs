<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Your first Datastore · Dark Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="We can use the trace of that HTTP request to build the endpoint. This is Trace Driven Development."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Your first Datastore · Dark Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://darklang.github.io/docs/"/><meta property="og:description" content="We can use the trace of that HTTP request to build the endpoint. This is Trace Driven Development."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/docs/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-159199190-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-159199190-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/favicon.ico" alt="Dark Documentation"/><h2 class="headerTitleWithLogo">Dark Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Getting Started</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/introduction">Hello World!</a></li><li class="navListItem"><a class="navItem" href="/docs/first-app">Your first app</a></li><li class="navListItem"><a class="navItem" href="/docs/first-api-endpoint">Your first API endpoint</a></li><li class="navListItem"><a class="navItem" href="/docs/first-repl">Your first REPL</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/first-datastore">Your first Datastore</a></li><li class="navListItem"><a class="navItem" href="/docs/first-cron">Your first CRON</a></li><li class="navListItem"><a class="navItem" href="/docs/first-worker">Your first Worker</a></li><li class="navListItem"><a class="navItem" href="/docs/finishing-touches">Finishing touches</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Concepts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/dark-backend-components">Components</a></li><li class="navListItem"><a class="navItem" href="/docs/trace-driven-development">Trace Driven Development</a></li><li class="navListItem"><a class="navItem" href="/docs/structured-editing">Structured Editing</a></li><li class="navListItem"><a class="navItem" href="/docs/error-handling">Error Handling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Language</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/language">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/datastores">Datastores</a></li><li class="navListItem"><a class="navItem" href="/docs/httpclient">HTTP Client</a></li><li class="navListItem"><a class="navItem" href="/docs/http">HTTP responses</a></li><li class="navListItem"><a class="navItem" href="/docs/packages">Packages</a></li><li class="navListItem"><a class="navItem" href="/docs/functional-aspects">Functional Aspects</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">How to</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/static-assets">Host Static Assets</a></li><li class="navListItem"><a class="navItem" href="/docs/custom-domains">Set a Custom Domain</a></li><li class="navListItem"><a class="navItem" href="/docs/teamwork">Work with your team</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials &amp; Samples</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/react-spa-tutorial">React SPA tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/slack-app-tutorial">Slack tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/twilio-app-tutorial">Twilio tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/sample-canvases">Sample Canvases</a></li><li class="navListItem"><a class="navItem" href="/docs/airtable">Airtable Sample</a></li><li class="navListItem"><a class="navItem" href="/docs/freshdesk">Freshdesk Sample</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/function-reference">Built-in Function reference</a></li><li class="navListItem"><a class="navItem" href="/docs/keyboard-mapping">Keyboard Mapping</a></li><li class="navListItem"><a class="navItem" href="/docs/support">Support</a></li><li class="navListItem"><a class="navItem" href="/docs/known-issues">Known issues</a></li><li class="navListItem"><a class="navItem" href="/docs/sharing-dark">Sharing Your Dark Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/changelog">Changelog</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Your first Datastore</h1></header><article><div><span><p>We can use the trace of that HTTP request to build the endpoint. This is Trace Driven Development.</p>
<ol>
<li>Hit the + button in the 404 section of the side bar to create the HTTP endpoint. The verb (POST) and route (/test) will be set for you.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.44.54_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.44.54_AM.png"></p>
<ol start="2">
<li>Hover over the white dot on the left hand side. Here, you'll see the full body of the incoming trace from when you posted to the endpoint from the REPL, including the body.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.45.57_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.45.57_AM.png"></p>
<ol start="3">
<li>Let's work with the request directly and save the incoming body to a record by typing <code>let data = request.body</code> again. The autocomplete will assist with the fieldnames.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.47.10_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.47.10_AM.png"></p>
<ol start="4">
<li>Let's put this in a datastore. Like our HttpClient library, typing &quot;DB&quot; in the blank will pull up all datastore functions.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.48.24_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.48.24_AM.png"></p>
<p>In this case, we want db::set, which takes three parameters.</p>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.48.51_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.48.51_AM.png"></p>
<ol start="5">
<li>Now let's make our datastore. From the sidebar or the omnibox, create a new datastore called &quot;requests&quot; and give it two field names.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/datastore.png" alt="assets/gettingstarted/datastore.png"></p>
<p>All datastores in Dark are key-value based and use keys as unique identifiers for the record. For instance, a possible set of records with keys in the above datastore would look like this:</p>
<pre><code class="hljs">{
  key1: {
          data: {
                  test: &quot;test2&quot;
                },
          time: &lt;Date: 2020-02-11T18:54:39Z&gt;
        },
  key2: {
          data: {
                  test: &quot;test1&quot;
                },
          time: &lt;Date: 2020-02-11T18:54:43Z&gt;
        }
}
</code></pre>
<ol start="6">
<li>Now that we have a datastore, let's finish our post endpoint.</li>
</ol>
<p>The first parameter is the record we're inserting. This will match our schema of date &amp; time. In Dark, all fields must be included for DB::set. We'll insert our data from above (seeing the live value to the left) and the Date::now function to get a time.</p>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.57.58_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.57.58_AM.png"></p>
<ol start="7">
<li>We'll need a unique key for each object. In this case, by typing db, we get the built in db::GenerateKey function.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_10.59.24_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_10.59.24_AM.png"></p>
<ol start="8">
<li>Lastly, we'll use the autocomplete to add our datastore, Requests.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_11.00.04_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_11.00.04_AM.png"></p>
<ol start="9">
<li>To run the DB::set operation on our existing trace, we first need to run the two functions with side effects (db::generateKey and Date::now) by hitting the play button. After hitting those two play buttons, DB::set will be green:</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_11.00.55_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_11.00.55_AM.png"></p>
<ol start="10">
<li>Finally, hitting the play button for DB::set will insert the record into the datastore, and lock the schema.</li>
</ol>
<p><img src="/docs/assets/gettingstarted/Screen_Shot_2020-02-11_at_11.01.32_AM.png" alt="assets/gettingstarted/Screen_Shot_2020-02-11_at_11.01.32_AM.png"></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/first-repl"><span class="arrow-prev">← </span><span>Your first REPL</span></a><a class="docs-next button" href="/docs/first-cron"><span>Your first CRON</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 Dark</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '1e1c6adb6b62f53c456dc70e833c2c26',
                indexName: 'darklang',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>